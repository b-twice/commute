"use strict";function $mapMouseOver(e){var t=e.feature.properties.dest.toLowerCase(),r=!0,o=!1,a=void 0;try{for(var n,i=Object.keys($select)[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var s=n.value;$(e._container).css(s,$select[s]),$(".area#"+t).css(s,$select[s]),$(".legend-item#"+t).css(s,$select[s])}}catch(c){o=!0,a=c}finally{try{!r&&i["return"]&&i["return"]()}finally{if(o)throw a}}d3.select(".area#"+t).moveToFront(),e.bringToFront()}function $mapMouseOut(e){var t=e.feature.properties.dest.toLowerCase(),r=!0,o=!1,a=void 0;try{for(var n,i=Object.keys($default)[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var s=n.value;$(e._container).css(s,$default[s]),$(".area#"+t).css(s,$default[s]),$(".legend-item#"+t).css(s,$default[s])}}catch(c){o=!0,a=c}finally{try{!r&&i["return"]&&i["return"]()}finally{if(o)throw a}}}function $graphMouseOver(){var e="#"+this.id,t=!0,r=!1,o=void 0;try{for(var a,n=Object.keys($select)[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var i=a.value;$(this).css(i,$select[i]),$(e).css(i,$select[i]),$(".legend-item"+e).css(i,$select[i])}}catch(s){r=!0,o=s}finally{try{!t&&n["return"]&&n["return"]()}finally{if(r)throw o}}d3.select(this).moveToFront()}function $graphMouseOut(){var e="#"+this.id,t=!0,r=!1,o=void 0;try{for(var a,n=Object.keys($select)[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var i=a.value;$(this).css(i,$default[i]),$(e).css(i,$default[i]),$(".legend-item"+e).css(i,$default[i])}}catch(s){r=!0,o=s}finally{try{!t&&n["return"]&&n["return"]()}finally{if(r)throw o}}}var $default={opacity:".5"},$select={opacity:".9"};d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},$(".legend-item").hover(function(){var e=($(this),$(this).attr("id")),t=!0,r=!1,o=void 0;try{for(var a,n=Object.keys($select)[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var i=a.value;$(".area#"+e).css(i,$select[i]),$(this).css(i,$select[i]),$("#"+e).css(i,$select[i])}}catch(s){r=!0,o=s}finally{try{!t&&n["return"]&&n["return"]()}finally{if(r)throw o}}d3.select(".area#"+e).moveToFront()},function(){var e=($(this),$(this).attr("id")),t=!0,r=!1,o=void 0;try{for(var a,n=Object.keys($select)[Symbol.iterator]();!(t=(a=n.next()).done);t=!0){var i=a.value;$(".area#"+e).css(i,$default[i]),$(this).css(i,$default[i]),$("#"+e).css(i,$default[i])}}catch(s){r=!0,o=s}finally{try{!t&&n["return"]&&n["return"]()}finally{if(r)throw o}}});var $color={work:"#2980b9",home:"#e74c3c",poi:"#8e44ad",overlap:"#8e44ad"};!function(){var e=$(".graph-container");$(window).load(function(){function t(){var t=e.width(),r=e.height();$("#graph").empty();var o=d3.select("#graph").append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+t+" "+r).attr("class","svg-content-responsive"),a=d3.scale.linear().range([0,t]),n=d3.scale.linear().range([r,0]),i=d3.svg.axis().scale(a).orient("bottom").ticks(5),s=d3.svg.axis().scale(n).orient("right").ticks(10),c=d3.svg.area().interpolate("basis").x(function(e){return a(e.distance)}).y0(r).y1(function(e){return n(e.elevation)});d3.csv("./public/graph.csv",function(e,t){t.forEach(function(e){e.distance=parseFloat(e.distance).toFixed(2),e.elevation=+e.elevation});var l=t.filter(function(e){return"work"==e.route}).sort(function(e,t){return d3.descending(e.distance,t.distance)}),u=t.filter(function(e){return"home"==e.route}).sort(function(e,t){return d3.ascending(e.distance,t.distance)});t=u.concat(l);var d=o.append("g");a.domain(d3.extent(t,function(e){return e.distance})),n.domain([0,d3.max(t,function(e){return e.elevation})]);var f=d3.nest().key(function(e){return e.route}).entries(t),v=!0,p=!1,$=void 0;try{for(var y,h=f[Symbol.iterator]();!(v=(y=h.next()).done);v=!0){var m=y.value;d.append("path").attr("class","area").attr("d",c(m.values)).attr("fill",$color[m.key]).attr("id",m.key).on("mouseover",$graphMouseOver).on("mouseout",$graphMouseOut)}}catch(g){p=!0,$=g}finally{try{!v&&h["return"]&&h["return"]()}finally{if(p)throw $}}o.append("g").attr("class","y axis").call(s),o.append("g").attr("class","x axis").attr("transform","translate(0,"+(r-30)+")").call(i)})}t(),window.onresize=t})}(window),function(){function e(e,n,i){function s(e,t){e.properties&&e.properties.description&&t.bindPopup(e.properties.description)}L.geoJson(i,{onEachFeature:s,pointToLayer:function(e,t){return L.circleMarker(t,o)}}).addTo(t);var c=topojson.feature(n,n.objects.commute);a.addData(c);var l=a.getBounds();l._southWest.lat-=.01,t.fitBounds(l),a.eachLayer(function(e,t){var o=e.feature.properties.dest.toLowerCase();e.setStyle(r).setStyle({color:$color[o]}),$(e._container).attr("id",o),$(e._container).css("opacity",".5"),e.on("mouseover",function(){!function(e){$mapMouseOver(e)}(e)}),e.on("mouseout",function(){!function(e){$mapMouseOut(e)}(e)})})}L.mapbox.accessToken="pk.eyJ1IjoiYnJicm93bmdlbyIsImEiOiJjYmVlMjEzNDhiYzcwZjU3ZmYwOGFmNzBkM2U1ZTcxMCJ9.o-fgdgUvU4Ks1k4TcrYhkw";var t=L.mapbox.map("map","mapbox.run-bike-hike",{maxZoom:20,minZoom:5}),r={width:5,opacity:1},o={radius:5,fillColor:$color.poi,color:$color.poi,weight:1,opacity:1,fillOpacity:.9},a=L.geoJson(null,{});t.addLayer(a),queue().defer(d3.json,"./public/commute.topo.json").defer(d3.json,"./public/poi.geo.json").await(e)}();